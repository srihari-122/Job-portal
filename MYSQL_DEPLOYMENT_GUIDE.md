# üöÄ Render Deployment Guide - Job Portal with MySQL/PostgreSQL

## üìã Database Options for Render

You have **THREE options** for your database:

### Option 1: üÜì **PostgreSQL on Render** (RECOMMENDED)
- ‚úÖ **FREE tier available**
- ‚úÖ Fully managed by Render
- ‚úÖ Automatic backups
- ‚úÖ Easy setup (1-click)
- ‚úÖ No external service needed

### Option 2: üê¨ **MySQL on External Service**
- ‚úÖ Free tiers available (PlanetScale, Railway)
- ‚ö†Ô∏è Requires external account
- ‚ö†Ô∏è Manual configuration

### Option 3: üóÑÔ∏è **MySQL on Render** (PAID)
- ‚ö†Ô∏è No free tier (starts at $7/month)
- ‚úÖ Fully managed

---

## ‚ö° Quick Start - Option 1: PostgreSQL on Render (EASIEST)

### Step 1: Push to GitHub (1 minute)
```bash
git add .
git commit -m "Deploy to Render with PostgreSQL"
git push origin main
```

### Step 2: Deploy on Render (3 minutes)
1. Go to https://dashboard.render.com
2. Click **"New +"** ‚Üí **"Blueprint"**
3. Connect your GitHub repository
4. Render will:
   - ‚úÖ Auto-detect `render.yaml`
   - ‚úÖ Create PostgreSQL database (FREE)
   - ‚úÖ Create web service
   - ‚úÖ Link them together automatically
5. Click **"Apply"**
6. Wait 5-10 minutes for deployment

### Step 3: Done! üéâ
- Your app is live at: `https://your-app-name.onrender.com`
- PostgreSQL database is automatically configured
- No additional setup needed!

---

## üê¨ Option 2: MySQL on External Service

### A. Using PlanetScale (FREE MySQL)

#### 1. Create PlanetScale Database (3 minutes)
```
1. Go to: https://planetscale.com
2. Sign up ‚Üí Create database
3. Name: job-portal-db
4. Region: Choose closest to your Render region
5. Click "Create database"
```

#### 2. Get Connection String
```
1. In PlanetScale dashboard ‚Üí "Connect"
2. Select "General" or "Python"
3. Copy connection string:
   mysql://user:password@host.psdb.cloud/job_portal?ssl={"rejectUnauthorized":true}
```

#### 3. Deploy on Render
```bash
# Push to GitHub
git add .
git commit -m "Deploy with PlanetScale MySQL"
git push origin main
```

```
1. Go to Render Dashboard
2. New+ ‚Üí Web Service
3. Connect repository
4. Settings:
   - Name: job-portal
   - Build: pip install -r requirements.txt && mkdir -p uploads
   - Start: uvicorn main:app --host 0.0.0.0 --port $PORT
5. Environment Variables:
   - DATABASE_URL: [Your PlanetScale connection string]
   - SECRET_KEY: [Auto-generate]
   - DEBUG: false
6. Click "Create Web Service"
```

### B. Using Railway (FREE MySQL)

#### 1. Create Railway Database
```
1. Go to: https://railway.app
2. New Project ‚Üí Provision MySQL
3. Copy connection string from Variables tab
```

#### 2. Deploy to Render
Same as PlanetScale, but use Railway connection string

---

## üóÑÔ∏è Option 3: MySQL on Render (Paid)

If you have budget ($7/month for MySQL):

### Update render.yaml
```yaml
databases:
  - name: job-portal-db
    databaseName: job_portal
    user: jobportal_user
    plan: starter  # $7/month for MySQL
    ipAllowList: []
```

Then deploy normally with Blueprint.

---

## üìù Connection String Formats

### PostgreSQL (Render Default)
```
postgresql://user:password@host:5432/database
```

### MySQL
```
mysql+pymysql://user:password@host:3306/database
```

### MySQL with SSL (PlanetScale)
```
mysql://user:password@host.psdb.cloud/database?ssl={"rejectUnauthorized":true}
```

---

## üîß Environment Variables

Add these in Render Dashboard ‚Üí Your Service ‚Üí Environment:

### Required Variables
```env
DATABASE_URL=postgresql://... or mysql://...
SECRET_KEY=<auto-generated>
DEBUG=false
DATABASE_NAME=job_portal
```

### Optional Variables
```env
ACCESS_TOKEN_EXPIRE_MINUTES=1440
MAX_FILE_SIZE=10485760
LOG_LEVEL=INFO
PYTHON_VERSION=3.11
```

---

## üìä Database Schema Setup

### For MySQL/PostgreSQL

After deployment, your app needs tables. Here's how:

#### Option A: Auto-migration (Recommended)
If your `main.py` has SQLAlchemy models:
```python
from sqlalchemy import create_engine
from your_models import Base

engine = create_engine(DATABASE_URL)
Base.metadata.create_all(engine)
```

#### Option B: Manual SQL
Connect to your database and run:
```sql
CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(255),
    role VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS jobs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    company VARCHAR(255),
    description TEXT,
    location VARCHAR(255),
    salary VARCHAR(100),
    created_by INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES users(id)
);

CREATE TABLE IF NOT EXISTS applications (
    id INT AUTO_INCREMENT PRIMARY KEY,
    job_id INT,
    user_id INT,
    status VARCHAR(50) DEFAULT 'applied',
    resume_path VARCHAR(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (job_id) REFERENCES jobs(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Add indexes for performance
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_jobs_created_by ON jobs(created_by);
CREATE INDEX idx_applications_job_user ON applications(job_id, user_id);
```

---

## ‚úÖ Testing Your Database Connection

### Test Locally First
```python
# test_db.py
from sqlalchemy import create_engine
import os

DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

try:
    connection = engine.connect()
    print("‚úÖ Database connection successful!")
    connection.close()
except Exception as e:
    print(f"‚ùå Database connection failed: {e}")
```

```bash
export DATABASE_URL="your-connection-string"
python test_db.py
```

---

## üîê Security Best Practices

### For Production Database:

1. **Use Strong Passwords**
   ```
   ‚úÖ Good: kJ#9mN$pQ2@xR7vL
   ‚ùå Bad: password123
   ```

2. **SSL/TLS Connection**
   - Always use SSL for external databases
   - Render PostgreSQL has SSL by default

3. **Environment Variables**
   - Never commit DATABASE_URL to git
   - Use Render's environment variables

4. **Connection Pooling**
   ```python
   engine = create_engine(
       DATABASE_URL,
       pool_size=5,
       max_overflow=10,
       pool_pre_ping=True
   )
   ```

---

## üìä Comparison Table

| Feature | Render PostgreSQL | PlanetScale MySQL | Railway MySQL | Render MySQL |
|---------|------------------|-------------------|---------------|--------------|
| **Price** | FREE | FREE | FREE (limited) | $7/month |
| **Setup Time** | 1 minute | 3 minutes | 3 minutes | 1 minute |
| **Storage** | 1 GB | 10 GB | 1 GB | Custom |
| **Backups** | ‚úÖ Yes | ‚úÖ Yes | ‚úÖ Yes | ‚úÖ Yes |
| **Complexity** | ‚≠ê Easy | ‚≠ê‚≠ê Medium | ‚≠ê‚≠ê Medium | ‚≠ê Easy |
| **Recommended** | ‚úÖ Best | ‚úÖ Good | ‚≠ê OK | ‚ö†Ô∏è Paid |

---

## üöÄ Recommended: PostgreSQL on Render

**Why?**
- ‚úÖ Completely FREE
- ‚úÖ Zero external services needed
- ‚úÖ Automatic configuration via `render.yaml`
- ‚úÖ Managed backups
- ‚úÖ Integrated with your app
- ‚úÖ No connection string copying needed

**PostgreSQL vs MySQL:**
- Both are SQL databases
- Both support same features
- Minor syntax differences (your app may need small updates)
- PostgreSQL is better for cloud deployments

---

## üîÑ Converting from MongoDB to MySQL/PostgreSQL

If your code uses MongoDB, you'll need to update:

### 1. Replace MongoDB Client
```python
# OLD (MongoDB)
from pymongo import MongoClient
client = MongoClient(DATABASE_URL)
db = client[DATABASE_NAME]

# NEW (MySQL/PostgreSQL)
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)
```

### 2. Replace Queries
```python
# OLD (MongoDB)
users = db.users.find({"email": email})

# NEW (SQLAlchemy)
from sqlalchemy import select
session = SessionLocal()
users = session.query(User).filter(User.email == email).all()
```

---

## üÜò Troubleshooting

### Connection Fails
```bash
# Check connection string format
# PostgreSQL: postgresql://...
# MySQL: mysql+pymysql://...

# Test locally first
python test_db.py
```

### SSL Certificate Errors (MySQL)
```python
# Add SSL parameters
DATABASE_URL = "mysql+pymysql://user:pass@host/db?ssl_ca=/etc/ssl/certs/ca-certificates.crt"
```

### Permission Denied
```sql
-- Grant permissions to user
GRANT ALL PRIVILEGES ON database_name.* TO 'username'@'%';
FLUSH PRIVILEGES;
```

---

## üìû Support Resources

- **Render PostgreSQL Docs:** https://render.com/docs/databases
- **PlanetScale Docs:** https://planetscale.com/docs
- **Railway Docs:** https://docs.railway.app/
- **SQLAlchemy Docs:** https://docs.sqlalchemy.org/

---

## üéâ Ready to Deploy!

### Quick Decision:

**Want easiest setup?** ‚Üí Use **PostgreSQL on Render** (Option 1)

**Must have MySQL?** ‚Üí Use **PlanetScale** (Option 2A)

**Have budget?** ‚Üí Use **Render MySQL** (Option 3)

---

## üöÄ Deploy Now!

```bash
# Final steps
git add .
git commit -m "Ready for Render with SQL database"
git push origin main

# Then go to Render and deploy!
```

---

**Your Job Portal will be live in 10 minutes! üéä**

**Choose your database option above and follow the steps!**

Good luck! üöÄ‚ú®




